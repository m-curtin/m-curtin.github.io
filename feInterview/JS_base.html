<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>01：JS数据类型 | 前端知识图谱</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="shortcut icon" type="image/x-icon" href="https://s1.ax1x.com/2020/06/21/N11p8I.th.jpg">
    <meta name="description" content="男儿的事业原本要昼夜不停">
    
    <link rel="preload" href="/assets/css/0.styles.8e15f8da.css" as="style"><link rel="preload" href="/assets/js/app.faf2e620.js" as="script"><link rel="preload" href="/assets/js/2.b545db22.js" as="script"><link rel="preload" href="/assets/js/24.a1eab233.js" as="script"><link rel="prefetch" href="/assets/js/10.0083a938.js"><link rel="prefetch" href="/assets/js/11.19e1f6e8.js"><link rel="prefetch" href="/assets/js/12.4b98931b.js"><link rel="prefetch" href="/assets/js/13.6441b0fb.js"><link rel="prefetch" href="/assets/js/14.f6d77b7a.js"><link rel="prefetch" href="/assets/js/15.60b7c674.js"><link rel="prefetch" href="/assets/js/16.8f15700f.js"><link rel="prefetch" href="/assets/js/17.dcd3f185.js"><link rel="prefetch" href="/assets/js/18.ce5b2a73.js"><link rel="prefetch" href="/assets/js/19.672d5ee0.js"><link rel="prefetch" href="/assets/js/20.4b93064c.js"><link rel="prefetch" href="/assets/js/21.24bb3691.js"><link rel="prefetch" href="/assets/js/22.71db6d8e.js"><link rel="prefetch" href="/assets/js/23.fa544eca.js"><link rel="prefetch" href="/assets/js/25.b5d090f9.js"><link rel="prefetch" href="/assets/js/26.0c890cb7.js"><link rel="prefetch" href="/assets/js/27.13a06163.js"><link rel="prefetch" href="/assets/js/28.0b39c226.js"><link rel="prefetch" href="/assets/js/29.53aced30.js"><link rel="prefetch" href="/assets/js/3.b8a6d1d4.js"><link rel="prefetch" href="/assets/js/30.595b8d89.js"><link rel="prefetch" href="/assets/js/31.89405e2e.js"><link rel="prefetch" href="/assets/js/32.7bef6ca9.js"><link rel="prefetch" href="/assets/js/33.8cc90fc9.js"><link rel="prefetch" href="/assets/js/4.4ee3c90b.js"><link rel="prefetch" href="/assets/js/5.f41643d5.js"><link rel="prefetch" href="/assets/js/6.b9a0c187.js"><link rel="prefetch" href="/assets/js/7.7a2398f6.js"><link rel="prefetch" href="/assets/js/8.efe2c089.js"><link rel="prefetch" href="/assets/js/9.f1a99ff5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8e15f8da.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">前端知识图谱</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/feInterview/" class="nav-link router-link-active">
  前端笔记
</a></div><div class="nav-item"><a href="/csInterview/" class="nav-link">
  计算机基础
</a></div><div class="nav-item"><a href="/JSalgorithm/" class="nav-link">
  数据结构与算法
</a></div><div class="nav-item"><a href="/JSachieve/" class="nav-link">
  JS 常用实现
</a></div><div class="nav-item"><a href="/Tools/" class="nav-link">
  生产工具
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  参考
</a></div><div class="nav-item"><a href="https://www.github.com/nonentityboy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/feInterview/" class="nav-link router-link-active">
  前端笔记
</a></div><div class="nav-item"><a href="/csInterview/" class="nav-link">
  计算机基础
</a></div><div class="nav-item"><a href="/JSalgorithm/" class="nav-link">
  数据结构与算法
</a></div><div class="nav-item"><a href="/JSachieve/" class="nav-link">
  JS 常用实现
</a></div><div class="nav-item"><a href="/Tools/" class="nav-link">
  生产工具
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  参考
</a></div><div class="nav-item"><a href="https://www.github.com/nonentityboy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/feInterview/css.html" class="sidebar-link">CSS</a></li><li><a href="/feInterview/JS_base.html" aria-current="page" class="active sidebar-link">JavaScript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_01-js数据类型" class="sidebar-link">01：JS数据类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_1-js原始数据类型有哪些-引用数据类型有哪些" class="sidebar-link">1. JS原始数据类型有哪些？引用数据类型有哪些？</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_2-null是对象吗" class="sidebar-link">2. null是对象吗？</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_3-判断数据类型" class="sidebar-link">3. 判断数据类型</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_4-object-prototype-tostring-call-原理" class="sidebar-link">4. Object.prototype.toString.call 原理</a></li></ul></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_02-讲讲symbol类型" class="sidebar-link">02：讲讲symbol类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#用法" class="sidebar-link">用法</a></li></ul></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_03-谈谈对闭包的理解" class="sidebar-link">03：谈谈对闭包的理解？</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_1-什么是闭包" class="sidebar-link">1. 什么是闭包？</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_2-闭包产生的原因" class="sidebar-link">2. 闭包产生的原因？</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_3-用途" class="sidebar-link">3. 用途</a></li></ul></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_04-异步" class="sidebar-link">04: 异步</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_1-同步代码运行背景" class="sidebar-link">1. 同步代码运行背景？</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_2-代码阻塞" class="sidebar-link">2. 代码阻塞</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_3-线程" class="sidebar-link">3. 线程</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_4-javascript-是单线程" class="sidebar-link">4. JavaScript 是单线程</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_5-异步代码" class="sidebar-link">5. 异步代码</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_6-总结" class="sidebar-link">6. 总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_05-javascript-超时和间隔执行" class="sidebar-link">05: JavaScript: 超时和间隔执行</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_1-概念" class="sidebar-link">1. 概念</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_2" class="sidebar-link">2.</a></li></ul></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_06-promise的理解" class="sidebar-link">06: Promise的理解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_1-概念-2" class="sidebar-link">1. 概念</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_2-状态" class="sidebar-link">2. 状态</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_3-特点" class="sidebar-link">3. 特点</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_4-promise-封装请求url" class="sidebar-link">4. Promise 封装请求url</a></li></ul></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_07-async与await" class="sidebar-link">07: async与await</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#封装请求url" class="sidebar-link">封装请求url</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#await-to-js" class="sidebar-link">await-to-js</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#使用方式" class="sidebar-link">使用方式</a></li></ul></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_08-genearte" class="sidebar-link">08: genearte</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_09-js内置对象键值对" class="sidebar-link">09: JS内置对象键值对</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_1-set" class="sidebar-link">1. Set</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_2-map" class="sidebar-link">2. Map</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_3-set与map区别" class="sidebar-link">3. set与map区别</a></li></ul></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_10-原型链" class="sidebar-link">10：原型链</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_1-概念-3" class="sidebar-link">1. 概念</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_2-instanceof-原理与实现" class="sidebar-link">2. instanceof 原理与实现</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_3-箭头函数" class="sidebar-link">3. 箭头函数</a></li></ul></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_11-event-loop" class="sidebar-link">11：event loop</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#前提" class="sidebar-link">前提</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#概念" class="sidebar-link">概念</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#任务类型" class="sidebar-link">任务类型</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#执行顺序" class="sidebar-link">执行顺序</a></li></ul></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_12-node-中的-event-loop" class="sidebar-link">12：Node 中的 Event loop</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#node事件循环" class="sidebar-link">Node事件循环</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#node-中的-nexttick" class="sidebar-link">Node 中的 nextTick</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#async-await函数" class="sidebar-link">async/await函数</a></li></ul></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_13-this" class="sidebar-link">13: this</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#常见规则" class="sidebar-link">常见规则</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#绑定顺序" class="sidebar-link">绑定顺序</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#箭头函数" class="sidebar-link">箭头函数</a></li></ul></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_14-javascript-高阶函数" class="sidebar-link">14: JavaScript 高阶函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#应用" class="sidebar-link">应用</a></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#数据是函数运作的基本" class="sidebar-link">数据是函数运作的基本</a></li></ul></li><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#_15-同步异步区别" class="sidebar-link">15: 同步异步区别</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/JS_base.html#单线程与异步" class="sidebar-link">单线程与异步</a></li></ul></li></ul></li><li><a href="/feInterview/vue.html" class="sidebar-link">Vue</a></li><li><a href="/feInterview/react.html" class="sidebar-link">React</a></li><li><a href="/feInterview/browserBase.html" class="sidebar-link">浏览器相关</a></li><li><a href="/feInterview/chrome.html" class="sidebar-link">Chrome</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_01-js数据类型"><a href="#_01-js数据类型" class="header-anchor">#</a> 01：JS数据类型</h2> <h3 id="_1-js原始数据类型有哪些-引用数据类型有哪些"><a href="#_1-js原始数据类型有哪些-引用数据类型有哪些" class="header-anchor">#</a> 1. JS原始数据类型有哪些？引用数据类型有哪些？</h3> <p>JS 中，存在着 7 种原始类型，分别是：<br> <code>boolean</code> <code>null</code> <code>undefined</code> <code>number</code> <code>string</code> <code>bigint</code> <code>symbol</code></p> <p>引用数据类型 6 种:
对象Object（ <code>普通对象-Object</code>，<code>数组对象-Array</code>，<code>正则对象-RegExp</code>，<code>日期对象-Date</code>，<code>数学函数-Math</code>，<code>函数对象-Function</code>）</p> <h3 id="_2-null是对象吗"><a href="#_2-null是对象吗" class="header-anchor">#</a> 2. null是对象吗？</h3> <p>JS 的最初版本中，使用 32 位系统，为了性能考虑使用低位存储了变量的类型信息，检测时 <code>000</code> 开头代表是对象，然而 <code>null</code> 表示为全零，所以将它错误的判断为 <code>object</code>。</p> <h3 id="_3-判断数据类型"><a href="#_3-判断数据类型" class="header-anchor">#</a> 3. 判断数据类型</h3> <p>基本类型：typeOf
判断类型：Object.prototype.toString.call(xx)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token string">'[object Object]'</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token number">2323</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token string">'[object Number]'</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">'asdasd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token string">'[object String]'</span>
</code></pre></div><h3 id="_4-object-prototype-tostring-call-原理"><a href="#_4-object-prototype-tostring-call-原理" class="header-anchor">#</a> 4. Object.prototype.toString.call 原理</h3> <p>参考：https://juejin.cn/post/7009659922342215688</p> <p>对于 Object.prototype.toString() 方法，会返回一个形如 “[object XXX]” 的字符串。
如果对象的 toString()方法未被重写，就会返回形如上面形式的字符串。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// =&gt; &quot;[object Object]&quot;</span>
Math<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// =&gt; &quot;[object Math]&quot;</span>

<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token comment">// '[object Object]'</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token comment">// '[object Object]'</span>
</code></pre></div><p>大多数对象对于toString()方法都是重写了的，因此这时需要使用 call()方法来调用未被重写前的toString方法.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;X&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

x<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                     <span class="token comment">// =&gt; &quot;X&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment">// '[object Object]</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// =&gt; &quot;[object Object]&quot;</span>
</code></pre></div><p>Object.prototype.toString.call(null);       // =&gt; &quot;[object Null]&quot;
Object.prototype.toString.call(undefined);  // =&gt; &quot;[object Undefined]&quot;</p> <h2 id="_02-讲讲symbol类型"><a href="#_02-讲讲symbol类型" class="header-anchor">#</a> 02：讲讲<code>symbol</code>类型</h2> <blockquote><p>概念：ES6 引入了新的原始数据类型 Symbol ，表示独一无二的值，最大的用法是用来定义对象的唯一属性名。</p></blockquote> <h3 id="用法"><a href="#用法" class="header-anchor">#</a> 用法</h3> <ul><li>不能用 <code>new命令</code>，它是原始类型，不是对象</li> <li>可以接收一个字符串作为参数</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> sy <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;lkt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sy<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// Symbol(KK)</span>
<span class="token keyword">typeof</span><span class="token punctuation">(</span>sy<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// &quot;symbol&quot;</span>

<span class="token comment">// 相同参数 Symbol() 返回的值不相等</span>
<span class="token keyword">let</span> sy1 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;lkt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sy <span class="token operator">===</span> sy1<span class="token punctuation">;</span>       <span class="token comment">// false</span>
</code></pre></div><h2 id="_03-谈谈对闭包的理解"><a href="#_03-谈谈对闭包的理解" class="header-anchor">#</a> 03：谈谈对闭包的理解？</h2> <h3 id="_1-什么是闭包"><a href="#_1-什么是闭包" class="header-anchor">#</a> 1. 什么是闭包？</h3> <p>红宝书上的定义：<code>闭包是有权访问另外一个函数作用域中的变量的函数</code>。</p> <p>MDN文档定义：<code>闭包是指那些能访问自由变量的函数</code>。</p> <p>综上：</p> <ul><li><ol><li>闭包是一个函数</li></ol></li> <li><ol start="2"><li>闭包可以访问另外一个函数作用域中的变量（自由变量）</li></ol></li></ul> <blockquote><p>（自由变量，指在函数中使用的，但既不是函数参数arguments也不是函数的局部变量的变量，其实就是另外一个函数作用域中的变量。）</p></blockquote> <h3 id="_2-闭包产生的原因"><a href="#_2-闭包产生的原因" class="header-anchor">#</a> 2. 闭包产生的原因？</h3> <p>ES5存在两种作用域：全局作用域、函数作用域</p> <blockquote><p>访问一个变量时，解释器会首先在当前作用域查找标示符，如果没有找到，就去父作用域找，直到找到该变量的标示符或者不在父作用域中，这就是作用域链</p></blockquote> <p>每一个子函数都会拷贝上级的作用域，形成一个作用域的链条。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// f1的作用域指向：有全局作用域(window)和它本身</span>
<span class="token comment">// f2的作用域指向：全局作用域(window)、f1和它本身</span>

<span class="token comment">// 作用域是从最底层向上找，直到找到全局作用域window为止，如果全局还没有的话会报错</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span>
  <span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//3</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>闭包产生的本质：<code>当前环境中存在指向父级作用域的引用</code></p> <h3 id="_3-用途"><a href="#_3-用途" class="header-anchor">#</a> 3. 用途</h3> <ul><li>可以读取函数内部的变量延长作用域，这些变量的值始终保持在内存中</li> <li>import ，模块化实际产生了一个闭包</li> <li>react 事件函数，return出一个组件</li></ul> <h2 id="_04-异步"><a href="#_04-异步" class="header-anchor">#</a> 04: 异步</h2> <p><img src="https://s2.loli.net/2021/12/13/S5mL8Iqi9hsBQDJ.png" alt="image.png"></p> <h3 id="_1-同步代码运行背景"><a href="#_1-同步代码运行背景" class="header-anchor">#</a> 1. 同步代码运行背景？</h3> <p>通常程序都是<code>顺序执行</code>，如果一个函数依赖于另一个函数的结果，它只能等待那个函数结束才能继续执行。
从用户的角度来说，整个程序才算运行完毕。</p> <h3 id="_2-代码阻塞"><a href="#_2-代码阻塞" class="header-anchor">#</a> 2. 代码阻塞</h3> <p>浏览器里面的一个Web应用进行<code>密集运算还没有把控制权返回给浏览器的时候</code>，整个浏览器就像冻僵了一样，这叫做<code>阻塞</code>。</p> <p>这时候浏览器无法继续处理用户的输入并执行其他任务，直到web应用交回处理器的控制。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> myDate<span class="token punctuation">;</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    myDate <span class="token operator">=</span> date
  <span class="token punctuation">}</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myDate<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> pElem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  pElem<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">'This is a newly-added paragraph.'</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>pElem<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>你会注意到，直到日期的运算结束，最后一个日期在console上显示出来，段落才会出现在网页上。代码按照源代码的顺序执行，<code>只有前面的代码结束运行，后面的代码才会执行。</code></p></blockquote> <p>为什么是这样? 答案是：JavaScript一般来说是单线程的（single threaded）。</p> <p>此时这个复杂计算占用主线程资源。</p> <h3 id="_3-线程"><a href="#_3-线程" class="header-anchor">#</a> 3. 线程</h3> <p>一个线程是一个基本的处理过程，程序用它来完成任务。每个线程一次只能执行一个任务:</p> <blockquote><p>Task A --&gt; Task B --&gt; Task C</p></blockquote> <p>只有前面的结束了，后面的才能开始。</p> <p>现在的计算机大都有多个内核（core），因此可以同时执行多个任务。支持多线程的编程语言可以使用计算机的多个内核，同时完成多个任务:</p> <blockquote><p>Thread 1: Task A --&gt; Task B</p> <p>Thread 2: Task C --&gt; Task D</p></blockquote> <h3 id="_4-javascript-是单线程"><a href="#_4-javascript-是单线程" class="header-anchor">#</a> 4. JavaScript 是单线程</h3> <p>JavaScript 传统上是单线程的。即使有多个内核，也只能在单一线程上运行多个任务，此线程称为主线程（main thread）。</p> <p>JavaScript获得了一些工具来帮助解决这种问题。通过 Web workers 可以把一些任务交给一个名为worker的单独的线程，这样就可以同时运行多个JavaScript代码块。一般<code>用一个worker来运行一个耗时的任务</code>，主线程就可以处理用户的交互（避免了阻塞）。</p> <blockquote><p>Main thread: Task A --&gt; Task C</p> <p>Worker thread: Expensive task B</p></blockquote> <h3 id="_5-异步代码"><a href="#_5-异步代码" class="header-anchor">#</a> 5. 异步代码</h3> <p>我们看下面的场景：比如说Task A 正在从服务器上获取一个图片之类的资源，Task B 准备在图片上加一个滤镜。如果开始运行Task A 后立即尝试运行Task B，你将会得到一个错误，因为图像还没有获取到。</p> <blockquote><p>Main thread: Task A --&gt; Task B --&gt; |Task D|</p> <p>Worker thread: Task C -----------&gt; |      |</p></blockquote> <p>在这种情况下，假设Task D 要同时使用 Task B 和Task C的结果，如果我们能保证这两个结果同时提供，程序可能正常运行，但是这不太可能。如果Task D 尝试在其中一个结果尚未可用的情况下就运行，程序就会抛出一个错误。</p> <p>为了解决这些问题，浏览器允许我们异步运行某些操作。像Promises 这样的功能就允许让一些操作运行 (比如：从服务器上获取图片)，然后等待直到结果返回，再运行其他的操作。</p> <blockquote><p>Main thread: <code>Task A Task B</code></p> <p>Promise:      <code>|__async operation__|</code></p></blockquote> <p>由于操作发生在其他地方，因此在处理异步操作的时候，主线程不会被阻塞。</p> <h3 id="_6-总结"><a href="#_6-总结" class="header-anchor">#</a> 6. 总结</h3> <p>为了让程序在一个时间内做更多的事情。当使用更新更强大的API时，更多的情况使用异步编程是唯一的途径。</p> <p>最基本的形式中，JavaScript是一种<code>同步的、阻塞的、单线程</code>的语言，在这种语言中，一次只能执行一个操作。但web浏览器定义了函数和API，允许我们当某些事件发生时不是按照同步方式，而是<code>异步地调用函数</code>(比如，<code>时间的推移，用户通过鼠标的交互，或者获取网络数据</code>)。这意味着您的代码可以同时做几件事情，而不需要停止或阻塞主线程。</p> <p>异步还是同步执行代码，取决于我们要做什么。</p> <ul><li><p>有时候希望事情能够立即加载并发生。例如，当将一些用户定义的样式应用到一个页面时，您希望这些样式能够尽快被应用。</p></li> <li><p>但是，如果我们正在运行一个需要时间的操作，比如查询数据库并使用结果填充模板，那么最好将该操作从主线程中移开使用异步完成任*务。</p></li></ul> <h2 id="_05-javascript-超时和间隔执行"><a href="#_05-javascript-超时和间隔执行" class="header-anchor">#</a> 05: JavaScript: 超时和间隔执行</h2> <h3 id="_1-概念"><a href="#_1-概念" class="header-anchor">#</a> 1. 概念</h3> <ul><li>setTimeout()
<ul><li>在指定的时间后执行一段代码.</li></ul></li> <li>setInterval()
<ul><li>以固定的时间间隔，重复运行一段代码.</li></ul></li> <li>requestAnimationFrame()
<ul><li>setInterval()的现代版本;在浏览器下一次重新绘制显示之前执行指定的代码块，从而允许动画在适当的帧率下运行，而不管它在什么环境中运行.</li></ul></li></ul> <h3 id="_2"><a href="#_2" class="header-anchor">#</a> 2.</h3> <h2 id="_06-promise的理解"><a href="#_06-promise的理解" class="header-anchor">#</a> 06: Promise的理解</h2> <p><a href="https://juejin.cn/post/7064389512729722910" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/7064389512729722910<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_1-概念-2"><a href="#_1-概念-2" class="header-anchor">#</a> 1. 概念</h3> <blockquote><p>Promise 对象用于表示一个异步操作的最终完成 (或失败)及其结果值。</p></blockquote> <h3 id="_2-状态"><a href="#_2-状态" class="header-anchor">#</a> 2. 状态</h3> <p>promise对象仅有三种状态</p> <ul><li>pending（进行中）</li> <li>fulfilled（已成功）</li> <li>rejected（已失败）</li></ul> <h3 id="_3-特点"><a href="#_3-特点" class="header-anchor">#</a> 3. 特点</h3> <ul><li>对象的状态不受外界影响，只有异步操作的结果，可以决定当前是哪一种状态</li> <li>一旦状态改变（从pending变为fulfilled和从pending变为rejected），就不会再变，任何时候都可以得到这个结果。</li></ul> <h3 id="_4-promise-封装请求url"><a href="#_4-promise-封装请求url" class="header-anchor">#</a> 4. Promise 封装请求url</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 封装请求函数</span>

<span class="token keyword">const</span> <span class="token function-variable function">request</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> params</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...do something</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用时</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleLogin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">request</span><span class="token punctuation">(</span>
    <span class="token string">'/basic/login'</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      usename<span class="token operator">:</span> <span class="token string">'sunshine'</span><span class="token punctuation">,</span>
      password<span class="token operator">:</span> <span class="token string">'123456'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// success do something</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// fail do something</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_07-async与await"><a href="#_07-async与await" class="header-anchor">#</a> 07: async与await</h2> <h3 id="封装请求url"><a href="#封装请求url" class="header-anchor">#</a> 封装请求url</h3> <p><code>Promise</code>的出现解决了很多问题，但是如果请求多了且有顺序要求的话，难免又会出现<code>嵌套</code>的问题，可读性较差，比如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">handleLogin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">request</span><span class="token punctuation">(</span>
    <span class="token string">'/basic/login'</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      usename<span class="token operator">:</span> <span class="token string">'sunshine'</span><span class="token punctuation">,</span>
      password<span class="token operator">:</span> <span class="token string">'123456'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 登录成功后获取用户信息</span>
    <span class="token function">request</span><span class="token punctuation">(</span>
      <span class="token string">'/basic/getuserinfo'</span><span class="token punctuation">,</span>
      res<span class="token punctuation">.</span>id
    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">info</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>userInfo <span class="token operator">=</span> info
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// fail do something</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">handleLogin</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token string">'/basic/login'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    usename<span class="token operator">:</span> <span class="token string">'sunshine'</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> <span class="token string">'123456'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> info <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token string">'/basic/getuserinfo'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> res<span class="token punctuation">.</span>id
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>userInfo <span class="token operator">=</span> info
<span class="token punctuation">}</span>
</code></pre></div><h3 id="await-to-js"><a href="#await-to-js" class="header-anchor">#</a> await-to-js</h3> <p>Promise有catch这个错误回调来保证请求错误后该做什么操作，但是async/await该如何捕获错误呢</p> <p>有一个库await-to-js已经帮我们做了这件事，我们可以看看它是怎么做的，它的源码只有短短十几行，我们应该读读它的源码，学学它的思想</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * @param { Promise } 传进去的请求函数
 * @param { Object= } errorExt - 拓展错误对象
 * @return { Promise } 返回一个Promise
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">to</span><span class="token punctuation">(</span>
  <span class="token parameter">promise<span class="token punctuation">,</span>
  errorExt</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> promise
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token keyword">null</span><span class="token punctuation">,</span> data<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>errorExt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> parsedError <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> err<span class="token punctuation">,</span> errorExt<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>parsedError<span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">return</span> <span class="token punctuation">[</span>err<span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> to

</code></pre></div><h3 id="使用方式"><a href="#使用方式" class="header-anchor">#</a> 使用方式</h3> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">const</span> <span class="token function-variable function">handleLogin</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>resErr<span class="token punctuation">,</span> res<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">to</span><span class="token punctuation">(</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token string">'/basic/login'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    usename<span class="token operator">:</span> <span class="token string">'sunshine'</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> <span class="token string">'123456'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>resErr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// fail do somthing</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>userErr<span class="token punctuation">,</span> info<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">to</span><span class="token punctuation">(</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token string">'/basic/getuserinfo'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> res<span class="token punctuation">.</span>id
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>userErr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// fail do somthing</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>userInfo <span class="token operator">=</span> info
<span class="token punctuation">}</span>

</code></pre></div><h2 id="_08-genearte"><a href="#_08-genearte" class="header-anchor">#</a> 08: genearte</h2> <h2 id="_09-js内置对象键值对"><a href="#_09-js内置对象键值对" class="header-anchor">#</a> 09: JS内置对象键值对</h2> <h3 id="_1-set"><a href="#_1-set" class="header-anchor">#</a> 1. Set</h3> <blockquote><p>概念：Set 对象允许你存储任何类型的唯一值，无论是原始值或者是对象引用。Set对象是值的集合，你可以按照插入的顺序迭代它的元素。 Set中的元素只会出现一次，即 Set 中的元素是唯一的。</p></blockquote> <p>has、add 时间复杂度：O(1)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">containsDuplicate</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">nums</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> x <span class="token keyword">of</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-map"><a href="#_2-map" class="header-anchor">#</a> 2. Map</h3> <h3 id="_3-set与map区别"><a href="#_3-set与map区别" class="header-anchor">#</a> 3. set与map区别</h3> <p>map 与 set 区别及常用方法：https://www.liaoxuefeng.com/wiki/1022910821149312/1023024181109440</p> <p>for in 与 for of区别： https://juejin.cn/post/6844903601261772808</p> <h2 id="_10-原型链"><a href="#_10-原型链" class="header-anchor">#</a> 10：原型链</h2> <h3 id="_1-概念-3"><a href="#_1-概念-3" class="header-anchor">#</a> 1. 概念</h3> <p>JavaScript 常被描述为一种基于原型的语言——每个对象拥有一个原型对象 <code>prototype</code>。</p> <ul><li>prototype: 显式原型</li> <li><code>__proto__</code>: 隐式原型</li></ul> <p>当试图访问一个对象的属性时，它不仅仅在该对象上搜寻，还会搜寻该对象的原型，以及该对象的原型的原型，依次层层向上搜索，直到找到一个名字匹配的属性或到达原型链的末尾。</p> <ul><li>原型链本质是链表（链表本质通过.next相互连接，原型链通过<code>__proto__</code>连接）</li> <li>原型链上节点是各种原型对象，比如：
<ul><li>Fuction.prototype、 Object.prototype ...</li></ul></li> <li>实例对象（object）都有一个私有属性（ <code>__proto__</code> ）指向它的原型对象（<code>prototype</code>）
<img src="https://raw.githubusercontent.com/Nonentityboy/PicGoToGitHub/study_note_blog/20220502192239.png" alt=""></li></ul> <blockquote><p>如果 A 验证原型链能找到B.prototype，那么 A instanceof B为 true。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">func</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

obj<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype <span class="token comment">// true</span>
obj <span class="token keyword">instanceof</span> <span class="token class-name">Object</span>   <span class="token comment">// true</span>

func<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Fuction</span><span class="token punctuation">.</span>prototype <span class="token comment">// true</span>
func<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype <span class="token comment">// true</span>
func <span class="token keyword">instanceof</span> <span class="token class-name">Fuction</span>   <span class="token comment">// true</span>
func <span class="token keyword">instanceof</span> <span class="token class-name">Object</span>   <span class="token comment">// true</span>

arr<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype <span class="token comment">// true</span>
arr<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype <span class="token comment">// true</span>
arr <span class="token keyword">instanceof</span> <span class="token class-name">Array</span>   <span class="token comment">// true</span>
arr <span class="token keyword">instanceof</span> <span class="token class-name">Object</span>   <span class="token comment">// true</span>
</code></pre></div><blockquote><p>如果 A 对象没找到 x 属性，那么会沿着原型链找 x 属性。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token string">'x'</span><span class="token punctuation">;</span>
<span class="token comment">// obj.x =&gt; x</span>
</code></pre></div><h3 id="_2-instanceof-原理与实现"><a href="#_2-instanceof-原理与实现" class="header-anchor">#</a> 2. instanceof 原理与实现</h3> <p>instanceof 实现：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">newInstanceOf</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">A</span><span class="token punctuation">,</span> <span class="token constant">B</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token constant">A</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">===</span> <span class="token class-name">B</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        p <span class="token operator">=</span> p<span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span> <span class="token comment">// 遍历原型链</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://raw.githubusercontent.com/Nonentityboy/PicGoToGitHub/study_note_blog/20220502202437.png" alt=""></p> <h3 id="_3-箭头函数"><a href="#_3-箭头函数" class="header-anchor">#</a> 3. 箭头函数</h3> <p>箭头函数不可以使用new实例化，这是因为箭头函数没有prototype也没有自己的this指向并且不可以使用arguments。</p> <p>new操作干的事情：</p> <ol><li>新生成一个对象</li> <li>链接到原型</li> <li>绑定this</li> <li>返回新对象</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 创建一个空的对象</span>
  <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 获得构造函数</span>
  <span class="token keyword">let</span> Con <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>
  <span class="token comment">// 链接到原型</span>
  obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> <span class="token class-name">Con</span><span class="token punctuation">.</span>prototype
  <span class="token comment">// 绑定 this，执行构造函数</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">Con</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
  <span class="token comment">// 确保 new 出来的是个对象</span>
  <span class="token keyword">return</span> <span class="token keyword">typeof</span> result <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">?</span> result <span class="token operator">:</span> obj
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_11-event-loop"><a href="#_11-event-loop" class="header-anchor">#</a> 11：event loop</h2> <p><a href="https://zhuanlan.zhihu.com/p/33058983" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/33058983<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://juejin.cn/post/6844903657264136200#heading-3" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/6844903657264136200#heading-3<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="前提"><a href="#前提" class="header-anchor">#</a> 前提</h3> <p>JS是非阻塞的单线程语言，JS 最初为了和<code>浏览器交互</code>而产生。</p> <blockquote><p>若 JS 是门多线程语言的话，在多个线程处理DOM就可能会有问题。（例如一个线程增加节点，另一个线程删除节点。）</p></blockquote> <p>JS 在执行过程中会产生执行环境，这些环境会被顺序的加入到执行栈，遇到异步的代码，会被挂起并加入到宏任务队列。</p> <blockquote><p>注意：微任务<code>先进先出，队列结构</code>。只有当await语句执行完毕之后，才会把await语句后面的全部代码加入到微任务列表中，记住，是加入<code>微任务列表</code>，且按照队列结构执行完成。</p></blockquote> <h3 id="概念"><a href="#概念" class="header-anchor">#</a> 概念</h3> <blockquote><p>JavaScript的执行顺序机制。</p></blockquote> <blockquote><p>事件循环的基本规则就是，执行完一个宏任务，再执行微任务队列中的所有微任务，再执行下一个宏任务...如此往复。</p> <p>因此一个事件循环可以视为一个<code>宏任务+所有微任务</code>，另外也可以把执行一个宏任务的阶段，或着执行所有微任务的阶段，称作一个 tick，由此可见一个事件循环由两个 tick组成。无论是对于Node中的 <code>process.nextTick</code>还是 Vue中的 <code>$.nextTick</code>，理解何为 tick都是很有帮助的。</p></blockquote> <h3 id="任务类型"><a href="#任务类型" class="header-anchor">#</a> 任务类型</h3> <p>微任务（microtask）：process.nextTick(Node) 、Promise.then/catch 、Object.observe(异步地监视一个对象的修改)、MutationObserver(监听当前DOM)</p> <p>宏任务（macrotask）：script ， setTimeout ，setInterval ，setImmediate(Node) ，I/O ，UI rendering, promise声明</p> <h3 id="执行顺序"><a href="#执行顺序" class="header-anchor">#</a> 执行顺序</h3> <ol><li>先执行当前同步代码，属于宏任务。</li> <li>遇到setTimeout等，塞给宏任务队列。（<code>下一轮宏任务执行</code>）</li> <li>查询当前微任务队列，处理微任务，处理完成，渲染UI。</li> <li>结束本次宏任务，（执行下一轮宏任务）。</li></ol> <h2 id="_12-node-中的-event-loop"><a href="#_12-node-中的-event-loop" class="header-anchor">#</a> 12：Node 中的 Event loop</h2> <p><a href="https://yuchengkai.cn/docs/frontend/browser.html#poll" target="_blank" rel="noopener noreferrer">https://yuchengkai.cn/docs/frontend/browser.html#poll<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>Node也是单线程，但是在处理Event Loop上与浏览器稍微有些不同，Node新增了两个方法可以用来使用：微任务的process.nextTick以及宏任务的setImmediate。</p></blockquote> <div class="language-JS extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timer1'</span><span class="token punctuation">)</span>

    Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timer2'</span><span class="token punctuation">)</span>

    Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise2'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="node事件循环"><a href="#node事件循环" class="header-anchor">#</a> Node事件循环</h3> <p>Node的架构和浏览器实现事件循环的方式也大相径庭。Node的事件循环中有六个阶段，每个阶段中都有一个宏队列，总共只有一个微队列和一个 nextTick队列。</p> <ul><li>Timer: SetTimeout和 SetInterval的回调放进该阶段的任务队列。</li> <li>pending callback: 执行一些系统操作的回调，例如TCP的错误。</li> <li>idle, prepare: 处理一些内部调用。</li> <li>poll: 大部分其他回调会被仿佛该阶段的任务队列</li> <li>check: SetImmediate的回调放进该阶段的任务队列。</li> <li>close callback: 一些结束时的回调，例如 Socket.on(&quot;close&quot;)</li></ul> <blockquote><p>重点关注三个阶段，Timer、poll、check。</p></blockquote> <blockquote><p>低版本（v11.0以前）的Node表现的行为和浏览器环境有很大的不同，是因为低版本下的Node在执行完<code>一个阶段的所有宏任务再执行微任务</code>；而高版本的Node表现和浏览器一致，即<code>执行完一个宏任务再执行微任务</code>。</p></blockquote> <div class="language-JS extra-class"><pre class="language-js"><code><span class="token comment">// 低版本：2134</span>
<span class="token comment">// 高版本：2143</span>
<span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><code>setImmediate</code>为一次Event Loop执行完毕后调用（一次宏任务、微任务结束。第二次宏任务队列调用。check阶段）</p> <h3 id="node-中的-nexttick"><a href="#node-中的-nexttick" class="header-anchor">#</a> Node 中的 nextTick</h3> <blockquote><p><code>process.nextTick</code>是Node独有的一个方法，顾名思义我们可以知道这个方法的目的是让某个任务在下一个 tick的最开始执行。比如，当我们处在一个宏任务阶段调用 process.nextTick，那么会在当前<code>宏任务执行结束后</code>，在后续的<code>微任务阶段执行前</code>执行 nextTick接受的回调函数。</p></blockquote> <blockquote><p>Node 中专门维护了一个 <code>nextTick 队列</code>, 每当我们执行完一个 tick(也就是执行完当前宏任务后)，就会执行 nextTick队列中的所有任务（微任务队列最前面加了个<code>nextTick队列</code>）。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
    process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
    process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="async-await函数"><a href="#async-await函数" class="header-anchor">#</a> async/await函数</h3> <p><a href="https://juejin.cn/post/6844903657264136200#heading-6" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/6844903657264136200#heading-6<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-JS extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token parameter">_</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><p>如上代码:</p> <ul><li>async函数在await之前的代码都是同步执行的，可以理解为await之前的代码属于new Promise时传入的代码</li> <li>await之后的所有代码都是在Promise.then中的回调</li></ul> <h2 id="_13-this"><a href="#_13-this" class="header-anchor">#</a> 13: this</h2> <h3 id="常见规则"><a href="#常见规则" class="header-anchor">#</a> 常见规则</h3> <p><code>this</code>记住几个规则就可以了。</p> <ol><li>在函数里面调用this，指向的是window</li> <li>作为对象方法调用，this指向的当前对象</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
	a<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  foo<span class="token operator">:</span> foo<span class="token punctuation">,</span>
  <span class="token function-variable function">foo2</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

obj<span class="token punctuation">.</span><span class="token function">foo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1 箭头函数当前执行作用域在window</span>
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 2 普通函数当前作用域在调用时这个对象上</span>
</code></pre></div><ol start="3"><li>new 优先级最高，只会绑定到c上，不会被任何方式修改<code>this</code>指向</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
c<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">3</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
</code></pre></div><ol start="4"><li>call、apply、bind 改变 this，这个优先级仅次于 new</li></ol> <h3 id="绑定顺序"><a href="#绑定顺序" class="header-anchor">#</a> 绑定顺序</h3> <p>new =&gt; call、apply、bind =&gt; 对象方法调用 =&gt; 函数直接调用</p> <h3 id="箭头函数"><a href="#箭头函数" class="header-anchor">#</a> 箭头函数</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Window</span>
</code></pre></div><ul><li>箭头函数没有 <code>this</code>，取决于他外面第一个不是箭头函数的<code>this</code></li> <li>this 一旦绑定上下文，就不会被代码改变</li></ul> <h2 id="_14-javascript-高阶函数"><a href="#_14-javascript-高阶函数" class="header-anchor">#</a> 14: JavaScript 高阶函数</h2> <h3 id="应用"><a href="#应用" class="header-anchor">#</a> 应用</h3> <p>高阶函数可以接收函数作为参数，同时也可以返回一个新的函数。</p> <blockquote><p>高阶函数之所以高阶，是因为高阶函数的参数和返回值对象可以是函数，这超越了普通函数处理的数据类型，例如字符串（strings）、数字（numbers）、布尔值（booleans）等。</p></blockquote> <p>JavaScript 中，函数的应用场景很丰富：</p> <ul><li>作为变量存储</li> <li>在数组中使用</li> <li>作为对象属性（即方法）</li> <li>作为参数传递</li> <li>作为其他函数的返回值</li></ul> <blockquote><p>理解高阶函数的关键在于，函数即数据。</p></blockquote> <h3 id="数据是函数运作的基本"><a href="#数据是函数运作的基本" class="header-anchor">#</a> 数据是函数运作的基本</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 字符串</span>
<span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hi, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
result <span class="token operator">=</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'Hi, User!'</span>

<span class="token comment">// 数字（Numbers）</span>
<span class="token function-variable function">double</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
result <span class="token operator">=</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 8</span>

<span class="token comment">// 布尔值（Booleans）</span>
<span class="token function-variable function">getClearance</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">allowed</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> allowed <span class="token operator">?</span>  <span class="token string">'Access granted'</span> <span class="token operator">:</span>  <span class="token string">'Access denied'</span><span class="token punctuation">;</span>
result1 <span class="token operator">=</span> <span class="token function">getClearance</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
result2 <span class="token operator">=</span> <span class="token function">getClearance</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'Access granted'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'Access denied'</span>

<span class="token comment">// 对象（Objects）</span>
<span class="token function-variable function">getFirstName</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> obj<span class="token punctuation">.</span>firstName<span class="token punctuation">;</span>
result <span class="token operator">=</span> <span class="token function">getFirstName</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	firstName<span class="token operator">:</span> <span class="token string">'Yazeed'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'Yazeed'</span>

<span class="token comment">// 数组（Arrays）</span>
<span class="token function-variable function">len</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">array</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> array<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
result <span class="token operator">=</span> <span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>

<span class="token comment">// 函数作为参数</span>
<span class="token function-variable function">isEven</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> num <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span>
result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>isEven<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [2, 4]</span>
</code></pre></div><p>函数作为返回值：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">y</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>

result <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
add5 <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
result <span class="token operator">=</span> <span class="token function">add5</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span> add5<span class="token punctuation">,</span> result <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { add5: [Function (anonymous)], result: 15 }</span>

<span class="token keyword">const</span> <span class="token function-variable function">emptyFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">handleSquareRes</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">func</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 函数作为参数，实现函数结果的阶乘</span>
<span class="token keyword">const</span> <span class="token function-variable function">emptyFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> e<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">handleSquareRes</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">func</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">handleSquareRes</span><span class="token punctuation">(</span><span class="token function">emptyFunc</span><span class="token punctuation">(</span><span class="token number">13223</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_15-同步异步区别"><a href="#_15-同步异步区别" class="header-anchor">#</a> 15: 同步异步区别</h2> <h3 id="单线程与异步"><a href="#单线程与异步" class="header-anchor">#</a> 单线程与异步</h3> <p>单线程同步导致问题：</p> <ul><li><code>JS是单线程语言</code>，只能同时做一件事。</li> <li>浏览器和 nodejs 支持 JS 启动 <code>进程</code>，如 Web Worker</li> <li>JS 和 DOM 渲染共用同一个线程（JS可修改DOM结构）</li></ul> <p>异步解决问题：</p> <ul><li>遇到等待（网络请求，定时任务）不能卡住</li> <li>需要异步、回调 callback 形式</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/17/2022, 11:40:57 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/feInterview/css.html" class="prev">
        CSS
      </a></span> <span class="next"><a href="/feInterview/vue.html">
        Vue
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.faf2e620.js" defer></script><script src="/assets/js/2.b545db22.js" defer></script><script src="/assets/js/24.a1eab233.js" defer></script>
  </body>
</html>
